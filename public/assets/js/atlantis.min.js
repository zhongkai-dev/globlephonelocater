/**
 * Simplified Atlantis Admin Dashboard JS
 * Version: 1.0.0
 */

"use strict";

// Atlantis main initialization
var Atlantis = {
    init: function() {
        this.initComponents();
        this.initNavigation();
        this.initScrollBar();
    },
    
    initComponents: function() {
        // Initialize tooltips
        $('[data-toggle="tooltip"]').tooltip();
        
        // Initialize popovers
        $('[data-toggle="popover"]').popover({
            html: true,
            container: 'body'
        });
        
        // Initialize DataTables
        if ($('.datatable').length > 0) {
            $('.datatable').DataTable({
                "pageLength": 10,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]
            });
        }
        
        // Handle flash messages
        setTimeout(function() {
            $('.alert-dismissible').fadeOut('slow');
        }, 3000);
    },
    
    initNavigation: function() {
        // Toggle sidebar
        $('.sidenav-toggler').on('click', function() {
            $('body').toggleClass('sidebar-mini');
            
            if ($('body').hasClass('sidebar-mini')) {
                localStorage.setItem('sidebar-mini', true);
            } else {
                localStorage.removeItem('sidebar-mini');
            }
        });
        
        // Check sidebar state
        if (localStorage.getItem('sidebar-mini') === 'true') {
            $('body').addClass('sidebar-mini');
        }
        
        // Set current navigation
        var currentPath = window.location.pathname;
        $('.nav .nav-item a').each(function() {
            var href = $(this).attr('href');
            if (currentPath.startsWith(href) && href !== '/') {
                $(this).parent().addClass('active');
            }
        });
    },
    
    initScrollBar: function() {
        // Simple scroll handling
        $('.scroll-content').each(function() {
            var ps = new PerfectScrollbar(this, {
                wheelSpeed: 1,
                wheelPropagation: true,
                minScrollbarLength: 20
            });
        });
    },
    
    showNotification: function(message, type) {
        type = type || 'info';
        
        let icon = 'fas fa-info-circle';
        
        if (type === 'success') icon = 'fas fa-check-circle';
        if (type === 'warning') icon = 'fas fa-exclamation-circle';
        if (type === 'danger') icon = 'fas fa-times-circle';
        
        const html = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                <i class="${icon} mr-2"></i> ${message}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        `;
        
        $('#notifications').prepend(html);
        
        setTimeout(function() {
            $('.alert-dismissible').fadeOut('slow');
        }, 3000);
    }
};

// Initialize when document is ready
$(document).ready(function() {
    Atlantis.init();
}); 